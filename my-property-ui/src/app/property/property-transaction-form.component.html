<div class="group-box">
    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center;">
        <h2>Property Transaction Form</h2>
        <button class="modal-close" type="button" (click)="closeModalClicked()" aria-label="Close">&times;</button>
    </div>
    <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()" class="property-form" autocomplete="off">
        <div class="form-sections">
            <div class="form-section">
                <div>
                    <label for="propertyId">Property <span style="color:red">*</span></label>
                    <select id="propertyId" formControlName="propertyId">
                        <option value="">Select</option>
                        <option *ngFor="let prop of propertyList" [value]="prop.id">{{ prop.title }}</option>
                    </select>
                    <div *ngIf="transactionForm.get('propertyId')?.invalid && (transactionForm.get('propertyId')?.dirty || transactionForm.get('propertyId')?.touched)" class="invalid-feedback" style="display: block; margin-top: 0.25rem;">
                        <small *ngIf="transactionForm.get('propertyId')?.errors?.['required']">Property is required</small>
                    </div>
                </div>
                <div>
                    <label for="buyAmount">Purchase Amount</label>
                    <input id="buyAmount" formControlName="buyAmount" [readonly]="true" />
                </div>
                <div>
                    <label for="totalLoan">Total Loan (if any)</label>
                    <input id="totalLoan" formControlName="totalLoan" [readonly]="true" />
                </div>
                <div>
                    <label for="amountPaidTillDate">Paid Till Date</label>
                    <input id="amountPaidTillDate" formControlName="amountPaidTillDate" [readonly]="true" />
                </div>
                <div>
                    <label for="balanceAmount">Outstanding Balance</label>
                    <input id="balanceAmount" formControlName="balanceAmount" [readonly]="true" />
                </div>
            </div>
            <div class="form-section">
                <div>
                    <label for="transactionType">Transaction Type <span style="color:red">*</span></label>
                    <select id="transactionType" formControlName="transactionType">
                        <option value="">Select</option>
                        <option *ngFor="let type of transactionTypes" [value]="type">{{ type }}</option>
                    </select>
                    <div *ngIf="transactionForm.get('transactionType')?.invalid && (transactionForm.get('transactionType')?.dirty || transactionForm.get('transactionType')?.touched)" class="invalid-feedback" style="display: block; margin-top: 0.25rem;">
                        <small *ngIf="transactionForm.get('transactionType')?.errors?.['required']">Transaction type is required</small>
                    </div>
                </div>
                <div>
                    <label for="amount">Transaction Amount <span style="color:red">*</span></label>
                    <input id="amount" type="text" formControlName="amount" (input)="onlyNumbers($event)" />
                    <div *ngIf="transactionForm.get('amount')?.invalid && (transactionForm.get('amount')?.dirty || transactionForm.get('amount')?.touched)" class="invalid-feedback" style="display: block; margin-top: 0.25rem;">
                        <small *ngIf="transactionForm.get('amount')?.errors?.['required']">Amount is required</small>
                        <small *ngIf="transactionForm.get('amount')?.errors?.['min']">Amount must be greater than 0</small>
                        <small *ngIf="transactionForm.get('amount')?.errors?.['exceedsOutstanding']">Transaction amount cannot exceed the outstanding balance</small>
                    </div>
                </div>
                <div>
                    <label for="paymentMethod">Payment Mode <span style="color:red">*</span></label>
                    <select id="paymentMethod" formControlName="paymentMethod">
                        <option value="">Select</option>
                        <option *ngFor="let mode of paymentModes" [value]="mode">{{ mode }}</option>
                    </select>
                    <div *ngIf="transactionForm.get('paymentMethod')?.invalid && (transactionForm.get('paymentMethod')?.dirty || transactionForm.get('paymentMethod')?.touched)" class="invalid-feedback" style="display: block; margin-top: 0.25rem;">
                        <small *ngIf="transactionForm.get('paymentMethod')?.errors?.['required']">Payment method is required</small>
                    </div>
                </div>
                <div>
                    <label for="referenceNumber">Reference Number</label>
                    <input id="referenceNumber" formControlName="referenceNumber" />
                </div>
                <div>
                    <label for="notes">Remarks</label>
                    <textarea id="notes" formControlName="notes" rows="3"></textarea>
                </div>
                <div>
                    <label for="transactionDate">Transaction Date <span style="color:red">*</span></label>
                    <input id="transactionDate" type="date" formControlName="transactionDate" />
                    <div *ngIf="transactionForm.get('transactionDate')?.invalid && (transactionForm.get('transactionDate')?.dirty || transactionForm.get('transactionDate')?.touched)" class="invalid-feedback" style="display: block; margin-top: 0.25rem;">
                        <small *ngIf="transactionForm.get('transactionDate')?.errors?.['required']">Transaction date is required</small>
                    </div>
                </div>
            </div>
        </div>

    <button type="submit" class="btn btn-primary" [disabled]="transactionForm.invalid || isSubmitting">Save</button>
    </form>
</div>