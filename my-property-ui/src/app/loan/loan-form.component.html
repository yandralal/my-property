<div class="group-box">
  <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center;">
    <h2>Property Loan Detail Form</h2>
    <button class="modal-close" type="button" (click)="closeModalClicked()" aria-label="Close">&times;</button>
  </div>
  <form [formGroup]="loanForm" (ngSubmit)="onSubmit()" class="loan-form" autocomplete="off">
    <div class="form-sections">
        <div class="form-section" style="flex: 1;">
          <div>
            <label for="property">Property *</label>
            <select id="property" formControlName="property"
              [class.is-invalid]="loanForm.get('property')?.invalid && loanForm.get('property')?.touched">
              <option value="">Select Property</option>
              <option *ngFor="let prop of properties" [value]="prop.id">{{ prop.title }}</option>
            </select>
            <div *ngIf="loanForm.get('property')?.invalid && loanForm.get('property')?.touched"
              class="invalid-feedback d-block">
              <span *ngIf="loanForm.get('property')?.errors?.['required']">Property is required.</span>
            </div>
          </div>
          <div>
            <label for="lenderName">Lender Name *</label>
            <input id="lenderName" formControlName="lenderName"
              [class.is-invalid]="loanForm.get('lenderName')?.invalid && loanForm.get('lenderName')?.touched" />
            <div *ngIf="loanForm.get('lenderName')?.invalid && loanForm.get('lenderName')?.touched"
              class="invalid-feedback d-block">
              <span *ngIf="loanForm.get('lenderName')?.errors?.['required']">Lender name is required.</span>
            </div>
          </div>
          <div>
            <label for="loanAmount">Loan Amount *</label>
            <input id="loanAmount" type="text" formControlName="loanAmount"
              (input)="patchFormattedField('loanAmount')"
              [class.is-invalid]="loanForm.get('loanAmount')?.invalid && loanForm.get('loanAmount')?.touched" />
            <div *ngIf="loanForm.get('loanAmount')?.invalid && loanForm.get('loanAmount')?.touched"
              class="invalid-feedback d-block">
              <span *ngIf="loanForm.get('loanAmount')?.errors?.['required']">Loan amount is required.</span>
              <span *ngIf="loanForm.get('loanAmount')?.errors?.['min']">Loan amount must be positive.</span>
            </div>
          </div>
          <div>
            <label for="interestRate">Interest Rate (%)*</label>
            <input id="interestRate" type="text" formControlName="interestRate"
              (input)="patchFormattedField('interestRate')"
              [class.is-invalid]="loanForm.get('interestRate')?.invalid && loanForm.get('interestRate')?.touched" />
            <div *ngIf="loanForm.get('interestRate')?.invalid && loanForm.get('interestRate')?.touched"
              class="invalid-feedback d-block">
              <span *ngIf="loanForm.get('interestRate')?.errors?.['required']">Interest rate is required.</span>
              <span *ngIf="loanForm.get('interestRate')?.errors?.['min']">Interest rate must be positive.</span>
            </div>
          </div>
          <div>
            <label for="tenure">Tenure (Months) *</label>
            <input id="tenure" type="text" formControlName="tenure"
              (input)="patchFormattedField('tenure')"
              [class.is-invalid]="loanForm.get('tenure')?.invalid && loanForm.get('tenure')?.touched" />
            <div *ngIf="loanForm.get('tenure')?.invalid && loanForm.get('tenure')?.touched"
              class="invalid-feedback d-block">
              <span *ngIf="loanForm.get('tenure')?.errors?.['required']">Tenure is required.</span>
              <span *ngIf="loanForm.get('tenure')?.errors?.['min']">Tenure must be positive.</span>
            </div>
          </div>
          <div>
            <label for="loanDate">Loan Date *</label>
            <input id="loanDate" type="date" formControlName="loanDate"
              [class.is-invalid]="loanForm.get('loanDate')?.invalid && loanForm.get('loanDate')?.touched" />
            <div *ngIf="loanForm.get('loanDate')?.invalid && loanForm.get('loanDate')?.touched"
              class="invalid-feedback d-block">
              <span *ngIf="loanForm.get('loanDate')?.errors?.['required']">Loan date is required.</span>
            </div>
          </div>
        </div>
      <div class="form-section">
        <div>
          <label for="totalInterest">Total Interest</label>
          <input id="totalInterest" formControlName="totalInterest" readonly />
        </div>
        <div>
          <label for="totalRepayment">Total Repayable</label>
          <input id="totalRepayment" formControlName="totalRepayment" readonly />
        </div>
        <div>
          <label for="remarks">Remarks</label>
          <textarea id="remarks" formControlName="remarks" rows="3"></textarea>
        </div>
      </div>
    </div>
    <div style="display: flex; justify-content: flex-end;">
      <button type="submit" class="btn btn-success">Save</button>
    </div>
  </form>
</div>